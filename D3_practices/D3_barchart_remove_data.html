<!DOCTYPE html>
<html>
<head>		
	<meta charset="utf-8">
	<script type="text/javascript" src="../d3/d3.v3.js" charset="utf-8"></script>
	<title>D3_barchart_update_data</title>
	<style type="text/css">
			.axis path,
			.axis line {
				fill: none;
				stroke: black;
				shape-rendering: crispEdges;
			}
			
			.axis text {
				font-family: sans-serif;
				font-size: 11px;
			}

	</style>
</head>
	<body>
		<p>click to add</p>

		<script type="text/javascript">
			
			var dataset = [1,2,3,4,5,6,7,8,9,10,11,12];
			console.log(dataset);
			
			var margin = {top:20, bottom:20, left:20, right:20};

			var w = 600 - margin.left - margin.right,
				h = 400 - margin.top - margin.right;

			var svg = d3.select("body")
				.append("svg")
				.attr("width",w + margin.left + margin.right)
				.attr("height",h + margin.top + margin.right)
				.append("g")
				.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			var xScale = d3.scale.ordinal()
				.domain(d3.range(dataset.length))
				.rangeBands([0,w],0.05);

			 var yScale = d3.scale.linear()
			 	.domain([0,d3.max(dataset)])
			 	.range([h,0]);



			  svg.selectAll("rect")
			 	.data(dataset)
			 	.enter()
			 	.append("rect")
			 	.attr("x",function(d,i){
			 		return xScale(i);
			 	})
			 	.attr("y",function(d){
			 		return yScale(d);
			 	})
			 	.attr("width",xScale.rangeBand())
			 	.attr("height",function(d){
			 		return h - yScale(d);
			 	});



			 var xAxis = d3.svg.axis()
			 	.scale(xScale)
			 	.orient("bottom")
			 	.ticks(5);

			 var yAxis = d3.svg.axis()
			 	.scale(yScale)
			 	.orient("left")
			 	.ticks(5);

			 svg.append("g")
			 	.attr("class","x axis")
			 	.attr("transform","translate(0,"+ h +")")
			 	.call(xAxis);

			 svg.append("g")
			 	.attr("class","y axis")
			 	.call(yAxis);

			 d3.select("p")
			 	.on("click",function(){

				 	dataset.shift();

			 		// var maxValue = 25;
			 		// var newNumber = Math.floor(Math.random()*maxValue);
			 		// dataset.push(newNumber);

				 	xScale.domain(d3.range(dataset.length));

 					yScale.domain([0,d3.max(dataset)])
					 	// .range([h,0]);

					console.log(dataset);
					console.log(d3.max(dataset));

				 	svg.select(".x.axis")
				 		.transition()
				 		.call(xAxis);

				 	svg.select(".y.axis")
				 		.transition()
				 		.call(yAxis);

				 	// var bars = svg.selectAll("rect")
				 	// 	.data(dataset)

				 	// bars.enter()
				 	// 	.append("rect")
				 	// 	.attr("x",w)
				 	// 	.attr("y",function(d){
				 	// 		return yScale(d);	
				 	// 	})
				 	// 	.attr("width", xScale.rangeBand())
				 	// 	.attr("height", function(d){
				 	// 		return h - yScale(d);
				 	// 	})

				 	// bars.transition()
				 	// 	.attr("x",function(d,i){
				 	// 		return xScale(i);
				 	// 	})
				 	// 	.attr("y",function(d){
				 	// 		return yScale(d);
				 	// 	})
				 	// 	.attr("width", xScale.rangeBand())
				 	// 	.attr("height", function(d){
				 	// 		return h - yScale(d);
				 	// 	})



				 	var bars = svg.selectAll("rect")
				 		.data(dataset)

				 	bars.exit()
					 	.transition()
					 	.attr("x",w)
					 	.remove();

				 	bars.transition()
				 		.attr("x",function(d,i){
				 			return xScale(i);
				 		})
				 		.attr("y",function(d){
				 			return yScale(d);
				 		})
				 		.attr("width", xScale.rangeBand())
				 		.attr("height", function(d){
				 			return h - yScale(d);
				 		})

				 	console.log(dataset);

			 	});


		</script>
	</body>
</html>